const config = require('../config');
const { cmd, commands } = require('../command');
const { runtime } = require('../lib/functions');
const axios = require('axios');

cmd({
    pattern: "menu",
    desc: "Show interactive menu system",
    category: "menu",
    react: "ðŸ§¾",
    filename: __filename
}, async (conn, mek, m, { from, reply }) => {
    try {
        const menuCaption = `â•­â”â”â”ã€” *${config.BOT_NAME}* ã€•â”â”â”â”ˆâŠ·â­–
â”ƒß·â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â­–
â”ƒß·â”‚ ðŸ‘‘ Oá—¯á‘ŽEá–‡ : *${config.OWNER_NAME}*
â”ƒß·â”‚ ðŸ¤– ð™±ð™°ð™¸ð™»ð™´ðšˆðš‚ : *Multi Device*
â”ƒß·â”‚ ðŸ’» äº‡ð‘Œð›²ð›¯ : *NodeJs*
â”ƒß·â”‚ ðŸš€ ð™¿ð™»ð™°ðšð™µðšð™¾ð™¼ : *Heroku*
â”ƒß·â”‚ âš™ï¸ ð›­ð›©ð·ð›¯ : *[${config.MODE}]*
â”ƒß·â”‚ ðŸ”£ ð™¿ðšð™´ð™µð™¸ðš‡ : *[${config.PREFIX}]*
â”ƒß·â”‚ ðŸ·ï¸ á´ ÉªÊ€êœ±Éªá´É´ : *4.0.0 Bá´‡á´›á´€*
â”ƒß·â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
â’ *á´›Êœá´‡ Ê€Éªá´‹á´€ xá´á´… á´¡Êœá´€á´›êœ±á´€á´˜á´˜ Ê™á´á´›*
â’ *24 Êœá´á´œÊ€êœ± á´É´ÊŸÉªÉ´á´‡ á´¡á´Ê€á´‹ÉªÉ´É¢*
â•­â”â”ã€” *ð›­ð›¯ðš´ã³ ð¿ð¼ð‘†äº‡* ã€•â”â”â”ˆâŠ·
â”ƒââ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Â·à¹
â”ƒââ”‚1ï¸âƒ£ âœ“ ðŸ“¥âž¢ *ðƒðŽð–ðð‹ðŽð€ðƒ ðŒð„ðð”*
â”ƒââ”‚2ï¸âƒ£ âœ“ ðŸ‘¥âž¢ *ð†ð‘ðŽð”ð ðŒð„ðð”*
â”ƒââ”‚3ï¸âƒ£ âœ“ ðŸ˜„âž¢ *ð…ð”ð ðŒð„ðð”*
â”ƒââ”‚4ï¸âƒ£ âœ“ ðŸ‘‘âž¢ *ðŽð–ðð„ð‘ ðŒð„ðð”*
â”ƒââ”‚5ï¸âƒ£ âœ“ ðŸ¤–âž¢ *ð€ðˆ ðŒð„ðð”*
â”ƒââ”‚6ï¸âƒ£ âœ“ ðŸŽŽâž¢ *ð€ððˆðŒð„ ðŒð„ðð”*
â”ƒââ”‚7ï¸âƒ£ âœ“ ðŸ”„âž¢ *ð‚ðŽðð•ð„ð‘ð“ ðŒð„ðð”*
â”ƒââ”‚8ï¸âƒ£ âœ“ ðŸ“Œâž¢ *ðŽð“ð‡ð„ð‘ ðŒð„ðð”*
â”ƒââ”‚9ï¸âƒ£ âœ“ ðŸ’žâž¢ *ð‘ð„ð€ð‚ð“ðˆðŽðð’ ðŒð„ðð”*
â”ƒââ”‚ðŸ”Ÿ âœ“ ðŸ âž¢ *ðŒð€ðˆð ðŒð„ðð”*
â”ƒââ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”ˆâŠ·â­–
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”ˆâŠ·â­–
> ${config.DESCRIPTION}`;

        const contextInfo = {
            mentionedJid: [m.sender],
            forwardingScore: 999,
            isForwarded: true,
            forwardedNewsletterMessageInfo: {
                newsletterJid: '120363379231303152@newsletter',
                newsletterName: config.OWNER_NAME,
                serverMessageId: 143
            }
        };

        // Function to send menu image with timeout
        const sendMenuImage = async () => {
            try {
                return await conn.sendMessage(
                    from,
                    {
                        image: { url: config.MENU_IMAGE_URL ||'https://files.catbox.moe/5umrna.jpg' },
                        caption: menuCaption,
                        contextInfo: contextInfo
                    },
                    { quoted: mek }
                );
            } catch (e) {
                console.log('Image send failed, falling back to text');
                return await conn.sendMessage(
                    from,
                    { text: menuCaption, contextInfo: contextInfo },
                    { quoted: mek }
                );
            }
        };

        // Function to send menu audio with timeout
        const sendMenuAudio = async () => {
            try {
                await new Promise(resolve => setTimeout(resolve, 1000)); // Small delay after image
                await conn.sendMessage(from, {
                    audio: { url: 'https://github.com/rrrrrrrrrr2008/Tt/raw/refs/heads/main/%23dj%20%23remix%20%23funny%20%23comedy%20%23video%20%23viralvideo%20%23love%20%23song%20@knockoutofficial2.mp3' },
                    mimetype: 'audio/mp4',
                    ptt: true,
                }, { quoted: mek });
            } catch (e) {
                console.log('Audio send failed, continuing without it');
            }
        };

        // Send image first, then audio sequentially
        let sentMsg;
        try {
            // Send image with 10s timeout
            sentMsg = await Promise.race([
                sendMenuImage(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Image send timeout')), 10000))
            ]);
            
            // Then send audio with 1s delay and 8s timeout
            await Promise.race([
                sendMenuAudio(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Audio send timeout')), 8000))
            ]);
        } catch (e) {
            console.log('Menu send error:', e);
            if (!sentMsg) {
                sentMsg = await conn.sendMessage(
                    from,
                    { text: menuCaption, contextInfo: contextInfo },
                    { quoted: mek }
                );
            }
        }
        
        const messageID = sentMsg.key.id;

        // Menu data (complete version)
        const menuData = {
            '1': {
                title: "ðŸ“¥ *ðƒðŽð–ðð‹ðŽð€ðƒ ðŒð„ðð”* ðŸ“¥",
                content: `â•­â”â”â”ã€” *ðƒðŽð–ðð‹ðŽð€ðƒ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ¥â”‚ ðŸŒ *Ñ•ÏƒÂ¢Î¹Î±â„“ Ð¼Ñ”âˆ‚Î¹Î±*
â”ƒâ¥â”‚ â€¢ êœ°á´€á´„á´‡Ê™á´á´á´‹ [url]
â”ƒâ¥â”‚ â€¢ á´á´‡á´…á´‡á´€êœ°ÉªÊ€á´‡mediafire [url]
â”ƒâ¥â”‚ â€¢ á´›Éªá´‹á´›á´á´‹ [url]
â”ƒâ¥â”‚ â€¢ á´›Éªá´¡Éªá´›á´›á´‡Ê€ [url]
â”ƒâ¥â”‚ â€¢ ÉªÉ´á´€êœ±á´›á´€ [url]
â”ƒâ¥â”‚ â€¢ á´€á´˜á´‹ [app]
â”ƒâ¥â”‚ â€¢ Éªá´É¢á´‡ [query]
â”ƒâ¥â”‚ â€¢ á´›á´›2 [url]
â”ƒâ¥â”‚ â€¢ á´˜ÉªÉ´êœ± [url]
â”ƒâ¥â”‚ â€¢ á´€á´˜á´‹2 [app]
â”ƒâ¥â”‚ â€¢ êœ°Ê™2 [url]
â”ƒâ¥â”‚ â€¢ á´˜ÉªÉ´á´›á´‡Ê€á´‡êœ±á´› [url]
â”ƒâ¥â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ¥â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ¥â”‚ ðŸŽµ *ðŒð”ð’ðˆð‚/ð•ðˆðƒð„ðŽ*
â”ƒâ¥â”‚ â€¢ êœ±á´˜á´á´›Éªêœ°Ê [query]
â”ƒâ¥â”‚ â€¢ á´˜ÊŸá´€Ê [song]
â”ƒâ¥â”‚ â€¢ á´˜ÊŸá´€Ê2-10 [song]
â”ƒâ¥â”‚ â€¢ á´€á´œá´…Éªá´ [url]
â”ƒâ¥â”‚ â€¢ á´ Éªá´…á´‡á´ [url]
â”ƒâ¥â”‚ â€¢ á´ Éªá´…á´‡á´2-10 [url]
â”ƒâ¥â”‚ â€¢ Êá´›á´á´˜3 [url]
â”ƒâ¥â”‚ â€¢ Êá´›á´á´˜4 [url]
â”ƒâ¥â”‚ â€¢ êœ±á´É´É¢ [name]
â”ƒâ¥â”‚ â€¢ á´…á´€Ê€á´€á´á´€ [name]
â”ƒâ¥â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '2': {
                title: "ðŸ‘¥ *ð†ð‘ðŽð”ð ðŒð„ðð”* ðŸ‘¥",
                content: `â•­â”â”â”ã€” *ð†ð‘ðŽð”ð ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâœ°â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ°â”‚ ðŸ› ï¸ *ðŒð€ðð€ð†ð„ðŒð„ðð“*
â”ƒâœ°â”‚ â€¢ É¢Ê€á´á´œá´˜ÊŸÉªÉ´á´‹
â”ƒâœ°â”‚ â€¢ á´‹Éªá´„á´‹á´€ÊŸÊŸ
â”ƒâœ°â”‚ â€¢ á´‹Éªá´„á´‹á´€ÊŸÊŸ2
â”ƒâœ°â”‚ â€¢ á´‹Éªá´„á´‹á´€ÊŸÊŸ3
â”ƒâœ°â”‚ â€¢ á´€á´…á´… @user
â”ƒâœ°â”‚ â€¢ Ê€á´‡á´á´á´ á´‡ @user
â”ƒâœ°â”‚ â€¢ á´‹Éªá´„á´‹ @user
â”ƒâœ°â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ°â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ°â”‚ âš¡ *ð€ðƒðŒðˆð ð“ðŽðŽð‹*
â”ƒâœ°â”‚ â€¢ á´˜Ê€á´‡á´á´á´›á´‡ @user
â”ƒâœ°â”‚ â€¢ á´…á´‡á´á´á´›á´‡ @user
â”ƒâœ°â”‚ â€¢ á´…Éªêœ±á´Éªêœ±êœ± 
â”ƒâœ°â”‚ â€¢ Ê€á´‡á´ á´á´‹á´‡
â”ƒâœ°â”‚ â€¢ á´á´œá´›á´‡ [time]
â”ƒâœ°â”‚ â€¢ á´œÉ´á´Éªá´›á´‡
â”ƒâœ°â”‚ â€¢ ÊŸá´á´„á´‹É¢á´„
â”ƒâœ°â”‚ â€¢ á´œÉ´ÊŸá´á´„á´‹É¢á´„
â”ƒâœ°â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ°â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ°â”‚ ðŸ·ï¸ *ð“ð€ð†ð†ððˆð†*
â”ƒâœ°â”‚ â€¢ á´›á´€É¢ @user
â”ƒâœ°â”‚ â€¢ ÊœÉªá´…á´‡á´›á´€É¢ [msg]
â”ƒâœ°â”‚ â€¢ á´›á´€É¢á´€ÊŸÊŸ
â”ƒâœ°â”‚ â€¢ á´›á´€êœ°á´€á´…á´ÉªÉ´êœ±
â”ƒâœ°â”‚ â€¢ ÉªÉ´á´ Éªá´›á´‡
â”ƒâœ°â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '3': {
                title: "ðŸ˜„ *ð…ð”ð ðŒð„ðð”* ðŸ˜„",
                content: `â•­â”â”â”ã€” *ð…ð”ð ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒââ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒââ”‚ ðŸŽ­ *ðˆðð“ð„ð‘ð€ð‚ð“ðˆð•ð„*
â”ƒââ”‚ â€¢ êœ±Êœá´€á´˜á´€Ê€
â”ƒââ”‚ â€¢ Ê€á´€á´›á´‡r @user
â”ƒââ”‚ â€¢ ÉªÉ´êœ±á´œÊŸá´› @user
â”ƒââ”‚ â€¢ Êœá´€á´„á´‹ @user
â”ƒââ”‚ â€¢ êœ±ÊœÉªá´˜ @user1 @user2
â”ƒââ”‚ â€¢ á´„Êœá´€Ê€á´€á´„á´›á´‡Ê€
â”ƒââ”‚ â€¢ á´˜Éªá´„á´‹á´œá´˜
â”ƒââ”‚ â€¢ á´Šá´á´‹á´‡
â”ƒââ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒââ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœªâ”‚ ðŸ˜‚ *ð‘ð„ð€ð‚ð“ðˆðŽðð’*
â”ƒââ”‚ â€¢ ÊœÊ€á´›
â”ƒââ”‚ â€¢ Êœá´˜Ê
â”ƒââ”‚ â€¢ êœ±Êá´…
â”ƒââ”‚ â€¢ á´€É´É¢á´‡Ê€
â”ƒââ”‚ â€¢ êœ±ÊœÊ
â”ƒââ”‚ â€¢ á´‹Éªêœ±êœ±
â”ƒââ”‚ â€¢ á´á´É´
â”ƒââ”‚ â€¢ á´„á´œÉ´êœ°á´œá´¢á´‡á´…
â”ƒââ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '4': {
                title: "ðŸ‘‘ *ðŽðð–ð„ð‘ ðŒð„ðð”* ðŸ‘‘",
                content: `â•­â”â”â”ã€” *ðŽð–ðð„ð‘ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâœ¿â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¿â”‚ âš ï¸ *ð‘ð„ð’ð“ð‘ðˆð‚ð“ð„ðƒ*
â”ƒâœ¿â”‚ â€¢ Ê™ÊŸá´á´„á´‹ @user
â”ƒâœ¿â”‚ â€¢ á´œÉ´Ê™ÊŸá´á´„á´‹ @user
â”ƒâœ¿â”‚ â€¢ êœ°á´œÊŸÊŸá´˜á´˜ [img]
â”ƒâœ¿â”‚ â€¢ êœ±á´‡á´›á´˜á´˜ [img]
â”ƒâœ¿â”‚ â€¢ Ê€á´‡êœ±á´›á´€Ê€á´›
â”ƒâœ¿â”‚ â€¢ êœ±Êœá´œá´›á´…á´á´¡É´
â”ƒâœ¿â”‚ â€¢ á´œá´˜á´…á´€á´›á´‡á´„á´á´…
â”ƒâœ¿â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€
â”ƒâœ¿â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¿â”‚ â„¹ï¸ *ðˆðð…ðŽ ð“ðŽðŽð‹*
â”ƒâœ¿â”‚ â€¢ É¢á´ŠÉªá´…
â”ƒâœ¿â”‚ â€¢ á´ŠÉªá´… @user
â”ƒâœ¿â”‚ â€¢ ÊŸÉªêœ±á´›á´„á´á´…
â”ƒâœ¿â”‚ â€¢ Ê™Ê€á´á´€á´…á´„á´€êœ±á´›
â”ƒâœ¿â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '5': {
                title: "ðŸ¤– *ð€ðˆ ðŒð„ðð”* ðŸ¤–",
                content: `â•­â”â”â”ã€” *ð€ðˆ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâ™¡â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ™¡â”‚ ðŸ’¬ *ð‚ð‡ð€ð“ ð€ðˆ*
â”ƒâ™¡â”‚ â€¢ á´€Éª [query]
â”ƒâ™¡â”‚ â€¢ É¢á´˜á´›3 [query]
â”ƒâ™¡â”‚ â€¢ É¢á´˜á´›2 [query]
â”ƒâ™¡â”‚ â€¢ É¢á´˜á´›á´ÉªÉ´Éª [query]
â”ƒâ™¡â”‚ â€¢ É¢á´˜á´› [query]
â”ƒâ™¡â”‚ â€¢ á´á´‡á´›á´€ [query]
â”ƒâ™¡â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ™¡â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ™¡â”‚ ðŸ–¼ï¸ *ðˆðŒð€ð†ð„ ð€ðˆ*
â”ƒâ™¡â”‚ â€¢ imagine [text]
â”ƒâ™¡â”‚ â€¢ imagine2 [text]
â”ƒâ™¡â”‚ â€¢ rw [wallpaper nema]
â”ƒâ™¡â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ™¡â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ™¡â”‚ ðŸ” *ð’ðð„ð‚ðˆð€ð‹ðˆð™ð„ðƒ*
â”ƒâ™¡â”‚ â€¢ Ê™ÊŸá´€á´„á´‹Ê™á´á´¢ [query]
â”ƒâ™¡â”‚ â€¢ ÊŸá´œá´á´€ [query]
â”ƒâ™¡â”‚ â€¢ á´…á´Š [query]
â”ƒâ™¡â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '6': {
                title: "ðŸŽŽ *ð€ððˆðŒð„ ðŒð„ðð”* ðŸŽŽ",
                content: `â•­â”â”â”ã€” *ð€ððˆðŒð„ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâœªâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœªâ”‚ ðŸ–¼ï¸ *ðˆðŒð€ð†ð„ð’*
â”ƒâœªâ”‚ â€¢ êœ°á´€á´„á´‹
â”ƒâœªâ”‚ â€¢ Ê™á´É¢
â”ƒâœªâ”‚ â€¢ á´€á´¡á´á´
â”ƒâœªâ”‚ â€¢ É¢á´€Ê€ÊŸ
â”ƒâœªâ”‚ â€¢ á´¡á´€Éªêœ°á´œ
â”ƒâœªâ”‚ â€¢ É´á´‡á´‹á´
â”ƒâœªâ”‚ â€¢ á´á´‡É¢É´á´œá´ÉªÉ´
â”ƒâœªâ”‚ â€¢ á´á´€Éªá´…
â”ƒâœªâ”‚ â€¢ ÊŸá´ÊŸÉª
â”ƒâœªâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœªâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœªâ”‚ ðŸŽ­ *ð‚ð‡ð€ð‘ð€ð“ð„ð‘ð’*
â”ƒâœªâ”‚ â€¢ á´€É´Éªá´á´‡É¢ÉªÊ€ÊŸ
â”ƒâœªâ”‚ â€¢ á´€É´Éªá´á´‡É¢ÉªÊ€ÊŸ1-5
â”ƒâœªâ”‚ â€¢ á´€É´Éªá´á´‡1-5
â”ƒâœªâ”‚ â€¢ êœ°á´xÉ¢ÉªÊ€ÊŸ
â”ƒâœªâ”‚ â€¢ É´á´€Ê€á´œá´›á´É´
â”ƒâœªâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '7': {
                title: "ðŸ”„ *ð‚ðŽðð•ð„ð‘ð“ ðŒð„ðð”* ðŸ”„",
                content: `â•­â”â”â”ã€” *ð‚ðŽðð•ð„ð‘ð“ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒà®ƒâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒà®ƒâ”‚ ðŸ–¼ï¸ *ðŒð„ðƒðˆð€*
â”ƒà®ƒâ”‚ â€¢ êœ±á´›Éªá´„á´‹á´‡Ê€ [img]
â”ƒà®ƒâ”‚ â€¢ êœ±á´›Éªá´„á´‹á´‡Ê€2 [img]
â”ƒà®ƒâ”‚ â€¢ á´‡á´á´á´ŠÉªá´Éªx ðŸ˜Ž+ðŸ˜‚
â”ƒà®ƒâ”‚ â€¢ á´›á´€á´‹á´‡ [name,text]
â”ƒà®ƒâ”‚ â€¢ á´›á´á´á´˜3 [video]
â”ƒà®ƒâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒà®ƒâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒà®ƒâ”‚ ðŸ“ *ð“ð„ð—ð“*
â”ƒà®ƒâ”‚ â€¢ êœ°á´€É´á´„Ê [text]
â”ƒà®ƒâ”‚ â€¢ á´›á´›êœ± [text]
â”ƒà®ƒâ”‚ â€¢ á´›Ê€á´› [text]
â”ƒà®ƒâ”‚ â€¢ Ê™á´€êœ±á´‡64 [text]
â”ƒà®ƒâ”‚ â€¢ á´œÉ´Ê™á´‡á´€êœ±á´‡ [text]
â”ƒà®ƒâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '8': {
                title: "ðŸ“Œ *ðŽð“ð‡ð„ð‘ ðŒð„ðð”* ðŸ“Œ",
                content: `â•­â”â”â”ã€” *ðŽð“ð‡ð„ð‘ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâœžâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ”‚ ðŸ•’ *ð”ð“ðˆð‹ðˆð“ðˆð„ð’*
â”ƒâœžâ”‚ â€¢ á´›Éªá´á´‡É´á´á´¡
â”ƒâœžâ”‚ â€¢ á´…á´€á´›á´‡
â”ƒâœžâ”‚ â€¢ á´„á´á´œÉ´á´› [num]
â”ƒâœžâ”‚ â€¢ á´„á´€ÊŸá´„á´œÊŸá´€á´›á´‡ [expr]
â”ƒâœžâ”‚ â€¢ á´„á´á´œÉ´á´›x
â”ƒâœžâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ”‚ ðŸŽ² *ð‘ð€ððƒðŽðŒ*
â”ƒâœžâ”‚ â€¢ êœ°ÉªÊŸá´˜
â”ƒâœžâ”‚ â€¢ á´„á´ÉªÉ´êœ°ÊŸÉªá´˜
â”ƒâœžâ”‚ â€¢ Ê€á´‡á´„á´ÊŸá´Ê€
â”ƒâœžâ”‚ â€¢ Ê€á´ÊŸÊŸ
â”ƒâœžâ”‚ â€¢ êœ°á´€á´„5
â”ƒâœžâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ”‚ ðŸ” *ð’ð„ð€ð‘ð‚ð‡*
â”ƒâœžâ”‚ â€¢ á´…á´‡êœ°ÉªÉ´á´‡ [word]
â”ƒâœžâ”‚ â€¢ É´á´‡á´¡êœ± 
â”ƒâœžâ”‚ â€¢ á´á´á´ Éªá´‡[name]
â”ƒâœžâ”‚ â€¢ á´¡á´‡á´€á´›Êœá´‡Ê€ [loc]
â”ƒâœžâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœžâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒà¿‡â”‚ ðŸ” *ð’ð„ð“ð“ðˆðð†*
â”ƒâœžâ”‚ â€¢ êœ±á´‡á´ á´€
â”ƒâœžâ”‚ â€¢ á´‡É´á´ 
â”ƒâœžâ”‚ â€¢ 
â”ƒâœžâ”‚ â€¢ 
â”ƒâœžâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '9': {
                title: "ðŸ’ž *ð‘ð„ð€ð‚ð“ðˆðŽðð’ ðŒð„ðð”* ðŸ’ž",
                content: `â•­â”â”â”ã€” *ð‘ð„ð€ð‚ð“ðˆðŽðð’ ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâœ¤â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¤â”‚ â¤ï¸ *ð€ð…ð…ð„ð‚ð“ðˆðŽð*
â”ƒâœ¤â”‚ â€¢ á´„á´œá´…á´…ÊŸá´‡@user
â”ƒâœ¤â”‚ â€¢ Êœá´œÉ¢ @user
â”ƒâœ¤â”‚ â€¢ á´‹Éªêœ±êœ± @user
â”ƒâœ¤â”‚ â€¢ ÊŸÉªá´„á´‹ @user
â”ƒâœ¤â”‚ â€¢ á´˜á´€á´› @user
â”ƒâœ¤â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¤â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¤â”‚ ðŸ˜‚ *ð…ð”ððð˜*
â”ƒâœ¤â”‚ â€¢ Ê™á´œÊŸÊŸÊ @user
â”ƒâœ¤â”‚ â€¢ Ê™á´É´á´‹ @user
â”ƒâœ¤â”‚ â€¢ Êá´‡á´‡á´›@user
â”ƒâœ¤â”‚ â€¢ êœ±ÊŸá´€á´˜ @user
â”ƒâœ¤â”‚ â€¢ á´‹ÉªÊŸÊŸ @user
â”ƒâœ¤â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¤â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâœ¤â”‚ ðŸ˜Š *ð„ð—ðð‘ð„ð’ð’ðˆðŽðð’*
â”ƒâœ¤â”‚ â€¢ Ê™ÊŸá´œêœ±Êœ @user
â”ƒâœ¤â”‚ â€¢ êœ±á´ÉªÊŸá´‡@user
â”ƒâœ¤â”‚ â€¢ Êœá´€á´˜á´˜Ê@user
â”ƒâœ¤â”‚ â€¢ á´¡ÉªÉ´á´‹ @user
â”ƒâœ¤â”‚ â€¢ á´˜á´á´‹á´‡ @user
â”ƒâœ¤â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '10': {
                title: "ðŸ  *ðŒð€ðˆð ðŒð„ðð”* ðŸ ",
                content: `â•­â”â”â”ã€” *ðŒð€ðˆð ðŒð„ðð”* ã€•â”â”â”â”ˆâŠ·
â”ƒâ‚â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ‚â”‚ â„¹ï¸ *Bot Info*
â”ƒâ‚â”‚ â€¢ á´˜ÉªÉ´É¢
â”ƒâ‚â”‚ â€¢ ÊŸÉªá´ á´‡
â”ƒâ‚â”‚ â€¢ á´€ÊŸÉªá´ á´‡
â”ƒâ‚â”‚ â€¢ Ê€á´œÉ´á´›Éªá´á´‡
â”ƒâ‚â”‚ â€¢ á´œá´˜á´›Éªá´á´‡
â”ƒâ‚â”‚ â€¢ Ê€á´‡á´˜á´
â”ƒâ‚â”‚ â€¢ á´á´¡É´á´‡Ê€
â”ƒâ‚â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ‚â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ‚â”‚ ðŸ› ï¸ *Controls*
â”ƒâ‚â”‚ â€¢ Ê€á´‡êœ±á´›á´€Ê€á´›
â”ƒâ‚â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            }
        };

        // Message handler with improved error handling
        const handler = async (msgData) => {
            try {
                const receivedMsg = msgData.messages[0];
                if (!receivedMsg?.message || !receivedMsg.key?.remoteJid) return;

                const isReplyToMenu = receivedMsg.message.extendedTextMessage?.contextInfo?.stanzaId === messageID;
                
                if (isReplyToMenu) {
                    const receivedText = receivedMsg.message.conversation || 
                                      receivedMsg.message.extendedTextMessage?.text;
                    const senderID = receivedMsg.key.remoteJid;

                    if (menuData[receivedText]) {
                        const selectedMenu = menuData[receivedText];
                        
                        try {
                            if (selectedMenu.image) {
                                await conn.sendMessage(
                                    senderID,
                                    {
                                        image: { url: config.MENU_IMAGE_URL || 'https://files.catbox.moe/k9ighj.jpg' },
                                        caption: selectedMenu.content,
                                        contextInfo: contextInfo
                                    },
                                    { quoted: receivedMsg }
                                );
                            } else {
                                await conn.sendMessage(
                                    senderID,
                                    { text: selectedMenu.content, contextInfo: contextInfo },
                                    { quoted: receivedMsg }
                                );
                            }

                            await conn.sendMessage(senderID, {
                                react: { text: 'âœ…', key: receivedMsg.key }
                            });

                        } catch (e) {
                            console.log('Menu reply error:', e);
                            await conn.sendMessage(
                                senderID,
                                { text: selectedMenu.content, contextInfo: contextInfo },
                                { quoted: receivedMsg }
                            );
                        }

                    } else {
                        await conn.sendMessage(
                            senderID,
                            {
                                text: `âŒ *Invalid Option!* âŒ\n\nPlease reply with a number between 1-10 to select a menu.\n\n*Example:* Reply with "1" for Download Menu\n\n> ${config.DESCRIPTION}`,
                                contextInfo: contextInfo
                            },
                            { quoted: receivedMsg }
                        );
                    }
                }
            } catch (e) {
                console.log('Handler error:', e);
            }
        };

        // Add listener
        conn.ev.on("messages.upsert", handler);

        // Remove listener after 5 minutes
        setTimeout(() => {
            conn.ev.off("messages.upsert", handler);
        }, 300000);

    } catch (e) {
        console.error('Menu Error:', e);
        try {
            await conn.sendMessage(
                from,
                { text: `âŒ Menu system is currently busy. Please try again later.\n\n> ${config.DESCRIPTION}` },
                { quoted: mek }
            );
        } catch (finalError) {
            console.log('Final error handling failed:', finalError);
        }
    }
});
